const messageTemplate = (message) => {
  var messages = []
  if (typeof message === 'string') {
    messages = [{
      text: message,
      type: 'text'
    }]
  } else if (Array.isArray(message)) {
    message.forEach(msg => {
      if (typeof msg === 'string') {
        let singleMessage = {
          text: msg,
          type: 'text'
        }
        messages.push(singleMessage)
      } else {
        messages.push(msg)
      }
    })
  } else {
    if (!message) throw new Error('You LINE message is empty')
    if (!message.type) throw new Error('Your LINE message is required to have a type')

    // object type message
    messages = [message]
  }

  return messages
}

const quickReply = (message, ...options) => {
  const msg = {
    'type': 'text',
    'text': message,
    'quickReply': {
      'items': options.map(op => (typeof op !== 'string' ? op : {
        'type': 'action',
        'action': {
          'type': 'message',
          'label': op,
          'text': op
        }
      }))
    }
  }

  console.log(msg)
  return msg
}

export default ({ }) => ({
  messageTemplate,
  quickReply,
  name: 'line'
})
